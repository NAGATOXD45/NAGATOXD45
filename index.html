<!DOCTYPE html>
<html>
  <style>
    h2 {
  text-align: center;
}
  </style>
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <link rel="stylesheet" type="text/css" href="assets/css/preloader.css">
  <link rel="stylesheet" type="text/css" href="CSS/preloader.css">
  <link rel="stylesheet" href="CSS/style.css">
  <title>CSMC VIRGENS ASUNTA</title>
  <meta content="" name="description">
  <meta content="" name="keywords">


   <!-- Google Fonts -->
   <link rel="preconnect" href="https://fonts.googleapis.com">
   <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
   <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Inter:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
 
   <!-- Vendor CSS Files -->
   <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
   <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
   <link href="assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet">
   <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
   <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
   <link href="assets/vendor/aos/aos.css" rel="stylesheet">
 
   <!-- Template Main CSS File -->
   <link href="assets/css/main.css" rel="stylesheet">



   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
   <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
   <script src="https://cdn.jsdelivr.net/npm/tableexport@5.2.0/dist/js/tableexport.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>


</head>
<body>
 <!-- <div id="preloader"></div>-->
 <div id="preloader">
  <div class="spinner"></div>
  <div class="image-container">
    <img src="assets/img/PRELOADER.png" alt="Imagen del preloader">
  </div>
</div>
<!-- ======= Header ======= -->
<header id="header" class="header d-flex align-items-center fixed-top">
  <div class="container-fluid container-xl d-flex align-items-center justify-content-between">

    <a href="index.html" class="logo d-flex align-items-center">
      <!-- Uncomment the line below if you also wish to use an image logo -->
      <!-- <img src="assets/img/logo.png" alt=""> -->
      <h1>CSMC</h1>
    </a>

    <i class="mobile-nav-toggle mobile-nav-show bi bi-list"></i>
    <i class="mobile-nav-toggle mobile-nav-hide d-none bi bi-x"></i>
    <nav id="navbar" class="navbar">
      <ul>
        <li><a href="index.html" class="active">INICIO</a></li>
        <li class="dropdown"><a href="#"><span>ESTADISTICOS</span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
          <ul>
            <li class="dropdown"><a href="#"><span>DEFINITIVOS</span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
              <ul>
           <li><a class="dropdown-item" href="violencia.html">VIOLENCIA</a></li>
           <li><a class="dropdown-item" href="violencia_sexual.html">VIOLENCIA-SEXUAL</a></li>
           <li><a class="dropdown-item" href="espectro_autista.html">ESPECTRO-AUTISTA</a></li>
           <li><a class="dropdown-item" href="comportamiento_0_17.html">COMPORTAMIENTO 0-17</a></li>
           <li><a class="dropdown-item" href="depresion.html">DEPRESION</a></li>
           <li><a class="dropdown-item" href="ansiedad.html">ANSIEDAD</a></li>
           <li><a class="dropdown-item" href="suicida.html">SUICIDA</a></li>
           <li><a class="dropdown-item" href="alcohol.html">ALCOHOL</a></li>
           <li><a class="dropdown-item" href="dependencia_alcohol.html">DEPENDENCIA-ALCOHOL</a></li>
           <li><a class="dropdown-item" href="psicoticos.html">PSICOTICOS</a></li>
           <li><a class="dropdown-item" href="p_episodio_psicotico.html">P-EPISODIO-PSICOTICO</a></li>
           <li><a class="dropdown-item" href="t_mental_grave.html">T-MENTAL-GRAVE</a></li>
           <li><a class="dropdown-item" href="bullyng.html">BULLYNG</a></li>
           <li><a class="dropdown-item" href="deterioro_cognitivo.html">DETERIORO-COGNITIVO</a></li>
           <li><a class="dropdown-item" href="auxilio_psicologico.html">AUXILIO-PSICOLOGICO</a></li>
              </ul>
            </li>
            <li><a href="reporte_40.html">REPORTE 40</a></li>
            <li><a href="produccion.html">PRODUCCION</a></li>
          </ul>
        </li>
        <li class="dropdown"><a href="#"><span>OTROS</span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
          <ul>
            <li class="dropdown"><a href="#"><span>MAS -></span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
              <ul>
                <li><a class="dropdown-item" href="seguimiento.html">SEGUIMIENTO</a></li>
                <li><a class="dropdown-item" href="gestantes.html">GESTANTES</a></li>
                <li><a class="dropdown-item" href="pcc.html">PCC</a></li>
                <li><a class="dropdown-item" href="acompañamiento.html">ACP TOTAL</a></li>
                <li><a class="dropdown-item" href="acompañamientoprof.html">ACP PROFESIONAL</a></li>
                <li><a class="dropdown-item" href="acogidas.html">ACOGIDAS</a></li>
                <li><a class="dropdown-item" href="evais.html">EVAIS</a></li>
                <li><a class="dropdown-item" href="asistente_social.html">ASISTENTE SOCIAL</a></li>
                
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="seguimiento.html">SEGUIMIENTO</a></li>
        </ul>
    </nav><!-- .navbar -->

  </div>
</header><!-- End Header -->

  <!-- ======= Hero Section ======= -->
  <section id="hero" class="hero d-flex align-items-center">
    <div class="container">
      <div class="row gy-4 d-flex justify-content-between">
        <div class="col-lg-6 order-2 order-lg-1 d-flex flex-column justify-content-center">
          <h2  data-aos="fade-up">VIRGENS ASUNTA DE CALCA</h2>
          <p data-aos="fade-up" data-aos-delay="100">"Aquí encontrarás el apoyo que necesitas para sanar tu mente y fortalecer tu espíritu Juntos, podemos construir un camino hacia una mente más saludable" Encuentra la paz interior en nuestro centro de salud mental Abre la puerta a una vida más plena y feliz a través de la atención integral de nuestra salud mental Tu bienestar mental es nuestra prioridad."</p>

                   <div class="row gy-4" data-aos="fade-up" data-aos-delay="400">

            <div class="col-lg-3 col-6">
              <div class="stats-item text-center w-100 h-100">
                <span data-purecounter-start="0" data-purecounter-end="75968" data-purecounter-duration="4" class="purecounter"></span>
                <p>POBLACION</p>
              </div>
            </div><!-- End Stats Item -->

            <div class="col-lg-3 col-6">
              <div class="stats-item text-center w-100 h-100">
                <span data-purecounter-start="0" data-purecounter-end="5977" data-purecounter-duration="4" class="purecounter"></span>
                <p>PACIENTES</p>
              </div>
            </div><!-- End Stats Item -->

            <div class="col-lg-3 col-6">
              <div class="stats-item text-center w-100 h-100">
                <span data-purecounter-start="0" data-purecounter-end="6750" data-purecounter-duration="4" class="purecounter"></span>
                <p>CASOS DE SALUD MENTAL</p>
              </div>
            </div><!-- End Stats Item -->

            <div class="col-lg-3 col-6">
              <div class="stats-item text-center w-100 h-100">
                <span data-purecounter-start="0" data-purecounter-end="22" data-purecounter-duration="4" class="purecounter"></span>
                <p>TRABAJADORES</p>
              </div>
            </div><!-- End Stats Item -->

          </div>
        </div>

        <div class="col-lg-5 order-1 order-lg-2 hero-img" data-aos="zoom-out">
          <img src="assets/img/hero-img.png" class="img-fluid mb-3 mb-lg-0" alt="">
        </div>

      </div>
      <div class="dropdown" style="float: left;">
        <button class="btn btn-success dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Mostrar
        </button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          <a class="dropdown-item" href="#" id="show200">200 registros</a>
          <a class="dropdown-item" href="#" id="show500">500 registros</a>
          <a class="dropdown-item" href="#" id="showAll">Todos los registros</a>
         </div>
        
      </div>
  <div class="container">

    <h1 align="center">DATOS-CSMC-VIRGEN-ASUNTA</h1>
    <br />
    <div class="row">
      <div class="col-md-2">
        <div class="form-group">
          <label for="search1">AÑO:</label>
          <input type="text" name="search1" id="search1" class="form-control">
        </div>
      </div>
      <div class="col-md-2">
        <div class="form-group">
          <label for="search2">MES:</label>
          <input type="text" name="search2" id="search2" class="form-control">
        </div>
      </div>
      <div class="col-md-2">
        <div class="form-group">
          <label for="search3">DIA:</label>
          <input type="text" name="search3" id="search3" class="form-control">
        </div>
      </div>
      <div class="col-md-2">
        <div class="form-group">
          <label for="search4">DNI:</label>
          <input type="text" name="search4" id="search4" class="form-control">
        </div>
      </div>
      <div class="col-md-2">
        <div class="form-group">
          <label for="search5">CODIGO:</label>
          <input type="text" name="search4" id="search5" class="form-control">
        </div>
      </div>
      <div class="col-md-2">
        <div class="form-group">
          <label for="search6">PERSONAL:</label>
          <input type="text" name="search4" id="search6" class="form-control">
        </div>
        
      </div>
      
    </div>
    <br />
    <div align="center">
      
      <button type="button" name="load_data" id="load_data" class="btn btn-outline-info btn-lg">CARGAR DATA</button>
      <button id="export-btn" class="btn btn-outline-success     btn-lg">Exportar a Excel</button>
      <button id="record_count_label" type="button" class="btn btn-success btn-lg" style="float: right;"></button>
    </div>
  </div>
  <br />
  <div class="table-responsive">
    <div class="container-fluid" id="employee_table">
    </div>
  </div>
    </div>
    </div>
  </section><!-- End Hero Section -->

    <main id="main">      
      <!-- ======= Footer ======= -->
      <footer id="footer" class="footer">
    
        <div class="container">
          <div class="row gy-4">
            <div class="col-lg-5 col-md-12 footer-info">
              <a href="index.html" class="logo d-flex align-items-center">
                <span>CSMC VIRGEN ASUNTA</span>
              </a>
              <p>CUIDAR LA SALUD MENTAL ES TAREA DE TODOS</p>
              <div class="social-links d-flex mt-4">
                <a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
                <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
                <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
                <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
              </div>
            </div>
    
            </div>
        </div>
    
        <div class="container mt-4">
          <div class="copyright">
            &copy; Copyright <strong><span>CSMC-V-ASUNTA</span></strong>. All Rights Reserved
          </div>
          <div class="credits">
            <!-- All the links in the footer should remain intact. -->
            <!-- You can delete the links only if you purchased the pro version. -->
            <!-- Licensing information: https://bootstrapmade.com/license/ -->
            <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/logis-bootstrap-logistics-website-template/ -->
            Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
          </div>
        </div>
    
      </footer><!-- End Footer -->
      <!-- End Footer -->



  <script>
$(document).ready(function(){
  $('#load_data').click(function(){
    $.ajax({
      url:"CSV/VIOLENCIA.csv",
      dataType:"text",
      success:function(data)
      {
        var employee_data = data.split(/\r?\n|\r/);
        var record_count = employee_data.length - 1;
        var table_data = '<table id="mi-tabla" class="table table-dark table-striped table-bordered border-light">';
        for(var count = 0; count<employee_data.length; count++)
        {
          var cell_data = employee_data[count].split(",");
          table_data += '<tr>';
          for(var cell_count=0; cell_count<cell_data.length; cell_count++)
          {
            if(count === 0)
            {
              table_data += '<th>'+cell_data[cell_count]+'</th>';
            }
            else
            {
              table_data += '<td>'+cell_data[cell_count]+'</td>';
            }
          }
          table_data += '</tr>';
        }
        table_data += '</table>';
        $('#employee_table').html(table_data);
        $('#record_count_label').text('TOTAL: ' + record_count);
      }
    });
  });

  $('#search1, #search2, #search3, #search4, #search5, #search6').on('keyup change', function(){
    var search1 = $('#search1').val().toLowerCase();
    var search2 = $('#search2').val().toLowerCase();
    var search3 = $('#search3').val().toLowerCase();
    var search4 = $('#search4').val().toLowerCase();
    var search5 = $('#search5').val().toLowerCase();
    var search6 = $('#search6').val().toLowerCase();
    var filtered_rows = 0;// variable para contar filas filtradas
    $('table tbody tr').each(function(index){
      if(index === 0){ // skip first row (column headers)
        return;
      }

      var text1 = $(this).find('td').eq(1).text().toLowerCase();
      var text2 = $(this).find('td').eq(2).text().toLowerCase();
      var text3 = $(this).find('td').eq(3).text().toLowerCase();
      var text4 = $(this).find('td').eq(5).text().toLowerCase();
      var text5 = $(this).find('td').eq(14).text().toLowerCase();
      var text6 = $(this).find('td').eq(13).text().toLowerCase();
      var match1 = true;
      var match2 = true;
      var match3 = true;
      var match4 = true;
      var match5 = true;
      var match6 = true;

      if(search1 !== ''){
        match1 = match1 && text1.indexOf(search1) !== -1;
      }

      if(search2 !== ''){
        match2 = match2 && text2.indexOf(search2) !== -1;
      }
      
      if(search3 !== ''){
        match3 = match3 && text3.indexOf(search3) !== -1;
      }
      
      if(search4 !== ''){
        match4 = match4 && text4.indexOf(search4) !== -1;
      }

      if(search5 !== ''){
        match5 = match5 && text5.indexOf(search5) !== -1;
      }

      if(search6 !== ''){
        match6 = match6 && text6.indexOf(search6) !== -1;
      }

      if(match1 && match2 && match3 && match4 && match5 && match6){
        $(this).show();
        filtered_rows++;//MOSTRAR CONTADOR
      } else{
        $(this).hide();
      }
    });
    $('#record_count_label').text('REGISTROS: ' + filtered_rows);  
  });


  $('#show200').click(function(){
    $('table tbody tr').hide();
    $('table tbody tr:lt(201)').show();
    $('#record_count_label').text('REGISTROS: ' + ($('table tbody tr:visible').length - 1));
  });

  $('#show500').click(function(){
    $('table tbody tr').hide();
    $('table tbody tr:lt(501)').show();
    $('#record_count_label').text('REGISTROS: ' + ($('table tbody tr:visible').length - 1));
  });

  $('#showAll').click(function(){
    $('table tbody tr').show();
    $('#record_count_label').text('REGISTROS: ' + ($('table tbody tr:visible').length - 1));
  });
});
$(document).ready(function() {
  $('.dropdown-toggle').dropdown();
});
    function exportToExcel() {
      /* Obtener los datos de la tabla */
      var table = document.getElementById('mi-tabla');
      var tableData = [];
      var visibleRows = table.querySelectorAll('tbody tr:not([style*="display: none"])');
      for (var i = 0, row; row = visibleRows[i]; i++) {
        var rowData = [];
        for (var j = 0, col; col = row.cells[j]; j++) {
          rowData.push(col.innerText);
        }
        tableData.push(rowData);
      }
  
      /* Crear un libro de Excel y agregar la hoja de trabajo */
      var workbook = XLSX.utils.book_new();
      var worksheet = XLSX.utils.aoa_to_sheet(tableData);
      XLSX.utils.book_append_sheet(workbook, worksheet, 'Tabla');
  
      /* Descargar el archivo de Excel */
      XLSX.writeFile(workbook, 'mi-tabla.xlsx');
    }
  
    document.getElementById('export-btn').addEventListener('click', exportToExcel);


 </script>
 <script>
   $(document).ready(function() {
     $('.dropdown-toggle').dropdown();
   });
 </script>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
 <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
 
  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <script src="/SCRIPT/VIOLENCIA.js"></script>
</body>
</html>